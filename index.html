
<!DOCTYPE html>
<html>
<head>
  <title>Escáner QR</title>
  <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; text-align: center; }
    video { width: 100%; max-width: 400px; border: 2px solid #ccc; border-radius: 10px; }
    p { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>Escanea un código QR</h2>
  <video id="preview"></video>
  <p id="output">Esperando escaneo...</p>

  <script>
    const sheetUrl = "https://script.google.com/macros/s/AKfycbzAjXQlSY5gHQG3gxxsaitJ8Q7r9mn5jCLtxTYYZQ9FR5ScZ3QZSbS3fZyCV1CqHwm2ww/exec"; // <--- reemplazar con tu URL

    let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });
    scanner.addListener('scan', function (content) {
      document.getElementById("output").textContent = "Código escaneado: " + content;

      fetch(sheetUrl, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ qrData: content })
      }).then(() => {
        console.log("Datos enviados a Google Sheet.");
      }).catch(err => {
        console.error("Error al enviar", err);
      });
    });

    Instascan.Camera.getCameras().then(function (cameras) {
      if (cameras.length > 0) {
        scanner.start(cameras[0]);
      } else {
        alert('No se encontró una cámara.');
      }
    }).catch(function (e) {
      console.error(e);
    });
  </script>
</body>
</html>
